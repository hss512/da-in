<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="/webjars/sockjs-client/1.1.2/sockjs.min.js"></script>
	<script src="/webjars/stomp-websocket/2.3.3/stomp.min.js"></script>
	<script th:inline="javascript">
        let socket = null;
        let isStomp = false;
        let userId = [[${userDetails}]]

        console.log(userId)

        function connectStomp(){
            let sock = new SockJS("/stompTest");
            let client = Stomp.over(sock);
            client.debug = null;
            isStomp = true;
            socket = client;

            client.connect({}, function (frame){
                console.log("소켓 연결 성공!", frame);
                /*client.send('/TTT', {}, "msg: hahaha");*/

                client.subscribe('/topic/user/' + userId, function (count){
                    console.log("alarm=", count.body);
                })
            })
        }

        connectStomp();
	</script>
	<meta charset="UTF-8">
	<title>Create</title>
	<link rel="stylesheet" href="/css/post.css">
</head>
<body>
<div class="container">
	<div class="main">
		<div class="user">
			<div class="username">
				<span>작성자 </span>
				<input type="text" name="username" th:value="${userDetails.nickname}" readonly/>
			</div>
		</div>
		<div class="title">
			<span>제목 </span>
			<input type="text" name="title" th:value="${board.title}" readonly/>
		</div>
		<div class="content">
			<label>
				<span>내용</span><br/>
				<textarea name="content" readonly>[[${board.content}]]</textarea>
			</label>
		</div>
		<div class="sort">
			<div class="age">
				<span>나이</span><br/>
				<input type="text" name="ltAge" th:value="${board.ageLt}" readonly/>
				<span>~</span>
				<input type="text" name="rtAge" th:value="${board.ageRt}" readonly/>
			</div>
			<br/>
			<div class="gender">
				<span>성별</span><br/>
				<input type="text" name="gender" th:value="${board.gender}" readonly/>
			</div>
			<br/>
			<div class="local">
				<span>스터디 장소</span><br/>
				<input type="text" name="local" th:value="${board.local}" readonly/>
			</div>
		</div>
		</br>
		<button type="button" onclick="history.back()">목록으로</button>
		<br/>
		<br/>
		<button type="button" th:onclick="'javascript:doScrap(' + ${userDetails.id} + ',' + ${board.id} +')'">스크랩</button>
	</div>
	<div class="reply_container">
		<div class="reply_write">
			<div class="reply_input">
				<label>
					<input id="reply_text_value" type="text" name="reply_text"/>
				</label>
			</div>
			<div class="reply_button">
				<button id="btnSend" type="button" th:onclick="'javascript:reply_write('+ ${userDetails.id} + ',' + ${board.id} + ')'">
					전송
				</button>
			</div>
		</div>
		<div class="reply_list">
			<!--<div class="reply">

			</div>-->
		</div>
		<div class="reply_page">

		</div>
	</div>
</div>
</body>
<script type="text/javascript" th:src="@{/js/post.js}"></script>
</html>